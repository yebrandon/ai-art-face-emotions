# AI Art Face Emotions

This repo contains two scripts. `image_analysis.py` will load a dataset of images generated by Stable Diffusion from [DiffusionDB](https://github.com/poloclub/diffusiondb), detect if each image contains a face, and, if it does, label the image with an emotion and save it. The emotions for each labelled image are saved to `image_results.csv`, and a tally of the results is saved to `image_results_summary.csv`.

`prompt_analysis.py` will read the prompts from the `image_results.csv` file and use the VADER Sentiment Analysis tool from the Python [Natural Language Toolkit (NLTK)](https://github.com/nltk/nltk) to label each prompt with a sentiment. The sentiments for each labelled prompt are saved to `prompt_results.csv`, and a tally of the results is saved to `prompt_results_summary.csv`.

An example of the program's results using the DiffusionDB `2m_random_50k` subset can be found in the `example_results` folder.

## Usage

### Image Analysis

1. `pip install deepface datasets`
2. Follow the instructions to install the `face_recognition` library [here](https://github.com/ageitgey/face_recognition#installation)
3. In `image_analysis.py`, configure `RESULTS_DIR_PATH`, `IMGS_DIR_PATH` and `SUBSET_NAME` to select the directory the csv files will be saved to, the directory the images with faces detected will be saved to, and the DiffusionDB data subset to use, respectively. These values are set to `results/`, `images/` and `2m_random_50k` by default
4. `python image_analysis.py`

Be aware that with large datasets, the image analysis script can take a long time to execute and occupy a significant amount of space with the images saved.

### Prompt Analysis

1. `pip install nltk`
2. In `prompt_analysis.py`, uncomment the two lines of code at the top of the file to download the VADER lexicon on execution. You will only need to do this once
3. Configure `RESULTS_DIR_PATH` to select the directory the csv files will be saved to. This value is set to `results/` by default
4. `python prompt_analysis.py`
